import { RollResult } from '../utils/cache'
import explode from './explode'

const openTest: (times: number, sides: number) => RollResult = (times, sides) => {
  const { rolls } = explode(times, sides)

  let value = 0
  let sum = 0
  for (const roll of rolls) {
    sum += roll
    if (roll < sides) {
      if (sum > value) {
        value = sum
      }
      sum = 0
    }
  }

  return {
    rolls,
    value,
  }
}

export default openTest
